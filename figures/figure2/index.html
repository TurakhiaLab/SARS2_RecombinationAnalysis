<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Fitness of Pango Recombinants</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <script src="https://d3js.org/d3.v4.js"></script>
    <script type="module" src="static/bubblePlot.js"></script>
    <script src="../common/util.js" type="module"></script>

    <div id="bubble"></div>

    <script type="module">
      import { bubblePlot } from "./static/bubblePlot.js";

      const bubbleScalingColor = function (size) {
        if (size < 50) {
          return "gray";
        } else if (size >= 50 && size < 500) {
          return "green";
        } else if (size >= 500 && size < 3000) {
          return "orange";
        } else if (3000 < size && size < 50000) {
          return "red";
        } else if (size >= 50000) {
          return "purple";
        }
      };
      const divID = "#bubble";

      const config = {
        // Main Plot Data
        x: "Month",
        y: "LogScore",
        r: "UShERClusterSize",

        // Statistics add for additional curves
        mean: "LogMean",
        max: "LogMax",
        median: "LogMedian",
        percentile99: "LogPercentile99",
        percentile90: "LogPercentile90",
        percentile9999: "LogPercentile9999",

        // Plot dimensions
        top: 100,
        right: 200,
        bottom: 150,
        left: 150,
        width: 1800,
        height: 900,

        // Plot axis settings
        axisTickLabelSize: "15",
        axisTitleSize: "25px",
        // Axis Titles
        yAxisTitle: "Fitness R/RA (log)",
        xAxisTitle: "Month",

        // Plotting settings and statistics
        bubbleColoringCallable: bubbleScalingColor,
        averageCurve: true,
        maxCurve: true,
        medianCurve: true,
        shadeArea: true,

        // Config for the figure legend
        legend: true,
        legendLabels: [
          "less than 50 descendants",
          "between 50 and 500 descendants",
          "between 500 and 3000 descendants",
          "between 3000 and 20000 descendants",
          "greater than 50000 descendants",
        ],
        legendColors: ["gray", "green", "orange", "red", "purple"],

        // Plot Interactivity settings
        toolTip: { div: "#bubble" },
      };

      const pangoClustersData = "data/pango_recombs_cluster_sizes.csv";
      const monthlyFitnessData = "data/monthly_fitness_stats.csv";

      // Graph for fitness of Pango-lineages over time
      bubblePlot(divID, pangoClustersData, monthlyFitnessData, config);
    </script>
  </body>
</html>
